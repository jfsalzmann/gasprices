library(jsonlite)
fromJSON(url)
fromJSON(txt=url)
url = url("https://www.powernext.com/data-feed/132735/139/558")
url = fread("https://www.powernext.com/data-feed/132735/139/558")
library(data.table)
url = fread("https://www.powernext.com/data-feed/132735/139/558")
fromJSON(url)
url = getURL("https://www.powernext.com/data-feed/132735/139/558")
url = readLines("https://www.powernext.com/data-feed/132735/139/558")
fromJSON(url)
fromJSON(url) %>% as.data.frame
library(tidyverse)
library(magrittr)
library(jsonlite)
library(data.table)
fromJSON(url) %>% as.data.frame
fromJSON(url.data) %>% as.data.frame
url = readLines("https://www.powernext.com/data-feed/132735/139/558")
json = fromJSON(url.data)
json = fromJSON(url.data)
json = fromJSON(url)
json = fromJSON(url[0])
json = fromJSON(url[0])
data = read_csv("data-constr/558.csv")
View(data)
library(tidyverse)
library(magrittr)
data = read_csv("data-constr/558.csv")
View(data)
library(tidyverse)
library(magrittr)
data = read_csv("data-constr/558.csv")
View(data)
library(readxl)
Gas_Price_DE <- read_excel("data-constr/Gas Price_DE.xlsx")
View(Gas_Price_DE)
data = read_csv("data-constr/Gad Price_DE.csv")
data = read_csv("data-constr/Gas Price_DE.csv")
View(data)
data558 = read_csv("data-constr/558.csv")
View(data558)
data558 = read_csv("data-constr/558.csv") %>% select(Gasprice,Gasday)
data_merged = data %>% bind_rows(data558)
data = read_csv("data-constr/Gas Price_DE.csv") %>% mutate(Gasday = as.date(Gasday))
data = read_csv("data-constr/Gas Price_DE.csv") %>% mutate(Gasday = date(Gasday))
library(tidyverse)
library(magrittr)
data558 = read_csv("data-constr/558.csv") %>% select(Gasprice,Gasday)
data = read_csv("data-constr/Gas Price_DE.csv",
col_types = cols(Gasday = col_date(format = "%d.%m.%y")))
data_merged = data %>% bind_rows(data558)
library(tidyverse)
library(magrittr)
data558 = read_csv("data-constr/558.csv") %>% select(Gasprice,Gasday)
data = read_csv("data-constr/Gas Price_DE.csv",
col_types = cols(Gasprice = col_double(),Gasday = col_date(format = "%d.%m.%y")))
data_merged = data %>% bind_rows(data558)
View(data_merged)
library(tidyverse)
library(magrittr)
data558 = read_csv("data-constr/558.csv") %>% select(Gasprice,Gasday)
data = read_csv("data-constr/Gas Price_DE.csv",
col_types = cols(Gasprice = col_double(),Gasday = col_date(format = "%d.%m.%y")))
data_merged = data %>% bind_rows(data558)
data_merged = data_merged[,colSums(is.na(data_merged))<nrow(data_merged)]
View(data_merged)
data_merged = data %>% bind_rows(data558) %>% filter(!is.na(Gasday))
library(tidyverse)
library(magrittr)
data558 = read_csv("data-constr/558.csv") %>% select(Gasprice,Gasday)
data = read_csv("data-constr/Gas Price_DE.csv",
col_types = cols(Gasprice = col_double(),Gasday = col_date(format = "%d.%m.%y")))
data_merged = data %>% bind_rows(data558) %>% filter(!is.na(Gasday))
data_merged %>%
write_csv("data-constr/gasprice_imputed.csv")
View(data_merged)
library(tidyverse)
library(magrittr)
data558 = read_csv("data-constr/558.csv") %>% select(Gasprice,Gasday)
data = read_csv("data-constr/Gas Price_DE.csv",
col_types = cols(Gasprice = col_double(),Gasday = col_date(format = "%d.%m.%y")))
data_merged = data %>% bind_rows(data558) %>% filter(!is.na(Gasday))
data_merged %>%
write_csv("data-constr/gasprice_imputed.csv")
View(data_merged)
load("data-constr/masters_jointz.RData")
names(all_variables_combined)
sort(names(all_variables_combined))
library("tidyverse")
library("hablar")
library("lubridate")
"%.%" = function(x,y){paste(x,y,sep = "")}
load('data-constr/final_weather_data.RData')
load('data-constr/DAX_data.RData')
load('data-constr/the_combined.Rdata')
load('data-constr/the_combined_rel.Rdata')
load('data-constr/Quarterly_GDP_data.Rdata')
load('data-constr/gas_price_data.Rdata')
load('data-constr/el_price_data.Rdata')
load('data-constr/co2_price_data.Rdata')
###### DATES & CYCLIC BEHAVIOR
startdate = as.Date("2017-11-01")
currentDate = Sys.Date()-1
date_full = seq(startdate, currentDate, by="days") %>% data.frame(date = .)
date_full %<>%
mutate(d_day = day(date),
d_month = month(date),
d_year = year(date),
d_weekday = wday(date),
d_week = week(date))
library("magrittr")
library("tidyverse")
library("hablar")
library("lubridate")
library("magrittr")
"%.%" = function(x,y){paste(x,y,sep = "")}
load('data-constr/final_weather_data.RData')
load('data-constr/DAX_data.RData')
load('data-constr/the_combined.Rdata')
load('data-constr/the_combined_rel.Rdata')
load('data-constr/Quarterly_GDP_data.Rdata')
load('data-constr/gas_price_data.Rdata')
load('data-constr/el_price_data.Rdata')
load('data-constr/co2_price_data.Rdata')
###### DATES & CYCLIC BEHAVIOR
startdate = as.Date("2017-11-01")
currentDate = Sys.Date()-1
date_full = seq(startdate, currentDate, by="days") %>% data.frame(date = .)
date_full %<>%
mutate(d_day = day(date),
d_month = month(date),
d_year = year(date),
d_weekday = wday(date),
d_week = week(date))
transform_sin = function(data){
data %>% select_if(is.numeric) %>%
rename_all(~ . %.% "_sin") %>% mutate_all(~sin(2*pi*./max(.))) %>% cbind(data)
}
transform_cos = function(data){
data %>% select(-contains("_sin")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "_cos") %>% mutate_all(~cos(2*pi*./max(.))) %>% cbind(data)
}
date_full %<>% transform_sin()
date_full %<>% transform_cos() %>%
select(-contains("year_"))
####### MASTER JOINTZ, y, na omit
all_variables_combined = date_full %>%
left_join(final_weather_data, by = 'date') %>%
left_join(DAX_data, by = 'date') %>%
left_join(data_the_combined, by = 'date') %>%
left_join(data_the_combined_rel, by = 'date') %>%
left_join(Quarterly_GDP, by = 'date') %>%
left_join(gas_data, by = 'date') %>%
left_join(el_data, by = 'date') %>%
left_join(co2_data, by = 'date') %>%
rename(y = total) %>%
na.omit()
###### FEATURE ENGINEERING: ln,square,elasticity,infinity
transform_ln = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__ln") %>% mutate_all(~log(.+1-min(.))) %>% cbind(data)
}
transform_sqrd = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__sqrd") %>% mutate_all(~ .^2) %>% cbind(data)
}
transform_elas = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__elas") %>% mutate_all(~ 1/.^2) %>% cbind(data)
}
all_variables_combined %<>% transform_ln()
all_variables_combined %<>% transform_sqrd()
all_variables_combined %<>% transform_elas() %>%
mutate(across(.cols = everything(), ~ ifelse(is.infinite(.x), max(s(.x))*1000, .x)))
######### LAG: 7 day w/ na interpolation
transform_lag = function(data,lag=1){
data %>% select(-contains("____"),-date,-contains("d_")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "____lag" %.% lag) %>% mutate_all(~ lag(.,order_by = data$date)) %>% cbind(data) %>%
mutate_all(~ na_interpolation(.))
}
transform_lag_diff = function(data,lag=1){
data %>% select(-contains("____"),-date,-contains("d_")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "____dlag" %.% lag) %>% mutate_all(~ .-lag(.,order_by = data$date)) %>% cbind(data) %>%
mutate_all(~ na_interpolation(.))
}
all_variables_combined %<>% transform_lag(7) %<>% transform_diff_lag(7)
all_variables_combined %<>% transform_lag(7) %<>% transform_lag_diff(7)
library(imputeTS)
all_variables_combined %<>% transform_lag(7) %<>% transform_lag_diff(7)
all_variables_combined
View(all_variables_combined)
all_variables_combined %>%
select(sort(names(.))) %>% View()
load('data-constr/final_weather_data.RData')
load('data-constr/DAX_data.RData')
load('data-constr/the_combined.Rdata')
load('data-constr/the_combined_rel.Rdata')
load('data-constr/Quarterly_GDP_data.Rdata')
load('data-constr/gas_price_data.Rdata')
load('data-constr/el_price_data.Rdata')
load('data-constr/co2_price_data.Rdata')
###### DATES & CYCLIC BEHAVIOR
startdate = as.Date("2017-11-01")
currentDate = Sys.Date()-1
date_full = seq(startdate, currentDate, by="days") %>% data.frame(date = .)
date_full %<>%
mutate(d_day = day(date),
d_month = month(date),
d_year = year(date),
d_weekday = wday(date),
d_week = week(date))
transform_sin = function(data){
data %>% select_if(is.numeric) %>%
rename_all(~ . %.% "_sin") %>% mutate_all(~sin(2*pi*./max(.))) %>% cbind(data)
}
transform_cos = function(data){
data %>% select(-contains("_sin")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "_cos") %>% mutate_all(~cos(2*pi*./max(.))) %>% cbind(data)
}
date_full %<>% transform_sin()
date_full %<>% transform_cos() %>%
select(-contains("year_"))
####### MASTER JOINTZ, y, na omit
all_variables_combined = date_full %>%
left_join(final_weather_data, by = 'date') %>%
left_join(DAX_data, by = 'date') %>%
left_join(data_the_combined, by = 'date') %>%
left_join(data_the_combined_rel, by = 'date') %>%
left_join(Quarterly_GDP, by = 'date') %>%
left_join(gas_data, by = 'date') %>%
left_join(el_data, by = 'date') %>%
left_join(co2_data, by = 'date') %>%
rename(y = total) %>%
na.omit()
###### FEATURE ENGINEERING: ln,square,elasticity,infinity
transform_ln = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__ln") %>% mutate_all(~log(.+1-min(.))) %>% cbind(data)
}
transform_sqrd = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__sqrd") %>% mutate_all(~ .^2) %>% cbind(data)
}
transform_elas = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__elas") %>% mutate_all(~ 1/.^2) %>% cbind(data)
}
all_variables_combined %<>% transform_ln()
all_variables_combined %<>% transform_sqrd()
all_variables_combined %<>% transform_elas() %>%
mutate(across(.cols = everything(), ~ ifelse(is.infinite(.x), max(s(.x))*1000, .x)))
######### LAG: 7 day w/ na interpolation
transform_lag = function(data,lag=1){
data %>% select(-contains("____"),-date,-contains("d_")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "____lag" %.% lag) %>% mutate_all(~ lag(.,order_by = data$date)) %>% cbind(data) %>%
mutate_all(~ na_interpolation(.))
}
transform_lag_diff = function(data,lag=1){
data %>% select(-contains("____"),-date,-contains("d_")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "____dlag" %.% lag) %>% mutate_all(~ .-lag(.,order_by = data$date)) %>% cbind(data) %>%
mutate_all(~ na_interpolation(.))
}
all_variables_combined %<>% transform_lag(7)
all_variables_combined %>%
select(y)
lags_only = all_variables_combined %>%
select(y) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7)
lags_only = all_variables_combined %>%
select(y,date) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
View(lags_only)
arima = all_variables_combined %>%
select(y,date) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(all_variables_combined,file="data-constr/masters_arima.RData")
all_variables_combined %>%
write_csv("data-constr/masters_arima.csv")
sarima = all_variables_combined %>%
select(y,date,contains("d_")) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(all_variables_combined,file="data-constr/masters_sarima.RData")
all_variables_combined %>%
write_csv("data-constr/masters_sarima.csv")
names(sarima)
all_variables_combined %>% select(contains("dd_"))
library(tidyverse)
library(hablar)
library(lubridate)
library(magrittr)
library(imputeTS)
"%.%" = function(x,y){paste(x,y,sep = "")}
load('data-constr/final_weather_data.RData')
load('data-constr/DAX_data.RData')
load('data-constr/the_combined.Rdata')
load('data-constr/the_combined_rel.Rdata')
load('data-constr/Quarterly_GDP_data.Rdata')
load('data-constr/gas_price_data.Rdata')
load('data-constr/el_price_data.Rdata')
load('data-constr/co2_price_data.Rdata')
###### DATES & CYCLIC BEHAVIOR
startdate = as.Date("2017-11-01")
currentDate = Sys.Date()-1
date_full = seq(startdate, currentDate, by="days") %>% data.frame(date = .)
date_full %<>%
mutate(dd_day = day(date),
dd_month = month(date),
dd_year = year(date),
dd_weekday = wday(date),
dd_week = week(date))
transform_sin = function(data){
data %>% select_if(is.numeric) %>%
rename_all(~ . %.% "_sin") %>% mutate_all(~sin(2*pi*./max(.))) %>% cbind(data)
}
transform_cos = function(data){
data %>% select(-contains("_sin")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "_cos") %>% mutate_all(~cos(2*pi*./max(.))) %>% cbind(data)
}
date_full %<>% transform_sin()
date_full %<>% transform_cos() %>%
select(-contains("year_"))
####### MASTER JOINTZ, y, na omit
all_variables_combined = date_full %>%
left_join(final_weather_data, by = 'date') %>%
left_join(DAX_data, by = 'date') %>%
left_join(data_the_combined, by = 'date') %>%
left_join(data_the_combined_rel, by = 'date') %>%
left_join(Quarterly_GDP, by = 'date') %>%
left_join(gas_data, by = 'date') %>%
left_join(el_data, by = 'date') %>%
left_join(co2_data, by = 'date') %>%
rename(y = total) %>%
na.omit()
###### FEATURE ENGINEERING: ln,square,elasticity,infinity
transform_ln = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__ln") %>% mutate_all(~log(.+1-min(.))) %>% cbind(data)
}
transform_sqrd = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__sqrd") %>% mutate_all(~ .^2) %>% cbind(data)
}
transform_elas = function(data){
data %>% select(-contains("__"),-date) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "__elas") %>% mutate_all(~ 1/.^2) %>% cbind(data)
}
all_variables_combined %<>% transform_ln()
all_variables_combined %<>% transform_sqrd()
all_variables_combined %<>% transform_elas() %>%
mutate(across(.cols = everything(), ~ ifelse(is.infinite(.x), max(s(.x))*1000, .x)))
######### LAG: 7 day w/ na interpolation
transform_lag = function(data,lag=1){
data %>% select(-contains("____"),-date,-contains("dd_")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "____lag" %.% lag) %>% mutate_all(~ lag(.,order_by = data$date)) %>% cbind(data) %>%
mutate_all(~ na_interpolation(.))
}
transform_lag_diff = function(data,lag=1){
data %>% select(-contains("____"),-date,-contains("dd_")) %>% select_if(is.numeric) %>%
rename_all(~ . %.% "____dlag" %.% lag) %>% mutate_all(~ .-lag(.,order_by = data$date)) %>% cbind(data) %>%
mutate_all(~ na_interpolation(.))
}
all_variables_combined %<>% transform_lag(7) #%>% transform_lag_diff(7)
save(all_variables_combined,file="data-constr/masters_jointz.RData")
all_variables_combined %>%
write_csv("data-constr/masters_jointz.csv")
arima = all_variables_combined %>%
select(y,date) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(all_variables_combined,file="data-constr/masters_arima.RData")
all_variables_combined %>%
write_csv("data-constr/masters_arima.csv")
sarima = all_variables_combined %>%
select(y,date,contains("d_")) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
sarima = all_variables_combined %>%
select(y,date,contains("dd_")) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(all_variables_combined,file="data-constr/masters_sarima.RData")
all_variables_combined %>%
write_csv("data-constr/masters_sarima.csv")
names(sarima)
names(arima)
arima = all_variables_combined %>%
select(y,date) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(arima,file="data-constr/masters_arima.RData")
arima %>% write_csv("data-constr/masters_arima.csv")
sarima = all_variables_combined %>%
select(y,date,contains("dd_")) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(arima,file="data-constr/masters_sarima.RData")
arima %>% write_csv("data-constr/masters_sarima.csv")
sarima = all_variables_combined %>%
select(y,date,contains("dd_")) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(sarima,file="data-constr/masters_sarima.RData")
sarima %>% write_csv("data-constr/masters_sarima.csv")
sarima = all_variables_combined %>%
select(y,date,contains("dd_")) %>%
transform_lag(1) %>%
transform_lag(2) %>%
transform_lag(3) %>%
transform_lag(4) %>%
transform_lag(5) %>%
transform_lag(6) %>%
transform_lag(7) %>%
select(-date)
save(sarima,file="data-constr/masters_sarima.RData")
sarima %>% write_csv("data-constr/masters_sarima.csv")
